# MWU/examples/classifier

This is a directory to which OCaml files are extracted from `MWU/oracleExtract.v`.
It also contains code for that connects the extracted program to a larger system
that employs the verified MWU to to solve a randomly generated linear
classification problem.

## Detailed Description

###Overview
The Python program in envProc.py randomly generates a hyperplane of given
dimension as well as a set of examples classifiable by the random hyperplane.

This environment then proceeds receiving weight vectors from the client and in
turn generates cost vectors and sends them back. In the case of this
classification algorithm, the cost vectors returned are actually defined as
"gain vectors" and are generated by finding a misclassified example and
generating a gain vector according to the following formula:

(-1/rho) * violating_example * label

This exchange of new weight vectors and gains proceeds until the set of
examples is fully classified. The system then proceeds to classify the same
example set via a Python implementation for comparison purposes.

###Description of Files for this Application
####envProc.py
This Python script implements the environment for the verified MWU client
to communicate with. It creates an instance of a classification problem using
the Classifier_Environment class found in Classifier_Environment.py and then
proceeds receiving weight vectors from the client and sending back appropriate
gain vectors until the example set is fully classified.

The script continues by creating an instance of the same example set in the
fully Python-reliant Classifier class and running the MWU algorithm in Python
for comparison purposes.

####Classifier_Environment.py
This file implements the Classifier_Environment class which is designed to be
used specifically with the verified MWU client as it accounts for the use of
dyadic weight vectors. The class allows for dyadic weight vectors to be used to
update the target classification vector and then uses this target and example
set to return a gain vector for the next round.

####Classifier.py
This class implements a fully independent instance of the MWU algorithm for
solving linear classifiers completely in Python. It can be initialized with an
example set and epsilon value and can then, when run, classify the example
set within a theoretically specified bound of iterations.

## Prerequisites
* OCaml (>= 4.04.0)
* Ocamlfind (>= 1.8.0)
* Zrith library

### As before, [OPAM](https://opam.ocaml.org/) is the best way to install prereqs:

#### Once OPAM is set-up with OCaml (>= 4.04.0):

```
opam install ocamlfind
opam install zarith
```

## Build Instructions

### Generating verified `extractedMWU.ml` (Optional)

```
cd ../
make
cd /examples/classifier
```
### Buidling from source

```
make
./init.sh
```

### Executing the system

Simply execute the three processes:

```
clientProc
```
```
envProc
```
```
env_client_interface
```

## Modifying the system

Check MWU_networking.pdf for a more detailed description of
how networking and communication between the processes can
be adapted.
